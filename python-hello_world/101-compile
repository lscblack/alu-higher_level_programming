#!/bin/bash
# Set the PYFILE environment variable
export PYFILE="main.py"
if [ -z "$PYFILE" ]; then
    echo "Error: The environment variable PYFILE is not set."
    exit 1
fi

# Check if the provided PYFILE contains the .py extension and remove it if necessary
if [[ "$PYFILE" == *.py ]]; then
    OUTPUT_FILE="${PYFILE%.py}c"
else
    OUTPUT_FILE="${PYFILE}c"
fi

# Compile the Python script
echo "Compiling $PYFILE ..."
python -m py_compile "$PYFILE"

# Check if the compilation was successful
if [ -f "__pycache__/$OUTPUT_FILE" ]; then
    mv "__pycache__/$OUTPUT_FILE" .
    rmdir "__pycache__"
    echo "Compilation successful. Output file: $OUTPUT_FILE"
else
    echo "Compilation failed."
    exit 1
fi
